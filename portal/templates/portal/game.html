{% extends "base.html" %}
{% load static player_ordering %}

{% block css %}
	<link href='/static/css/game.css' rel='stylesheet' type='text/css'>
	<script src="{{ STATIC_URL }}js/jquery.min.js" type="text/javascript"></script>
	<script src="{{ STATIC_URL }}js/game.js" type="text/javascript"></script>
	<script>
		$(function() {
		
			var update_timer;
			set_timer()
			
			function set_timer() {
				update_timer = setInterval(function() { update() }, 3000);
			}
			
			function update() {
				clearInterval(update_timer);
				$.ajax({
					url: "{% url 'get_update' %}",
					type: "POST",
					data: { game: {{ game.id }},
					        player: {{ user.id }} },
					
				}).done(function(update) {
					update_game(update);
					set_timer();
				});
			}
		});
	</script>
{% endblock %}

{% block content %}
		<div id="game">
			<div id="players">
				{% include "includes/players.html" %}
			</div>
			
			<div id="playfield-centerer">
				<div id="playfield-container">
					{% include "includes/playfield.html" %}
				</div>
			</div>
			
			<div id="extra_info">
				{% include "includes/extra_info.html" %}
			</div>
			
		</div>
		<a href="/" style="position: absolute; bottom: 5px; right: 10px;">Back to portal</a>
{% endblock %}
